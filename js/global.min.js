function updateClock(){var e=new Date,t=new Array(7);t[0]="Söndag",t[1]="Måndag",t[2]="Tisdag",t[3]="Onsdag",t[4]="Torsdag",t[5]="Fredag",t[6]="Lördag",$("#currenttime").html(e.toLocaleTimeString("sv-SE")),$("#currentday").html(t[e.getDay()]),$("#currentdate").html(e.toLocaleDateString("sv-SE")),$(".traffic-result").each(function(){var t=$(this).children(".traffic-third").children(".departure-time").attr("value"),a=new Date(t);e>=a&&$(this).animate({bottom:"0px",opacity:.25,height:"toggle",padding:"0px",margin:"0px"},1500,"easeInQuart",function(){$(this).remove()})}),console.log(),$("#traffic-results").children(".traffic-result").length<=2&&$("#traffic-results").children(".traffic-result").length>0&&(getBus(),console.log("Too few buses, getting busses"))}function getBus(){var e=$("#traffic-search-input").val();if(""==e);else;console.log(e),$("#traffic-loading").addClass("traffic-loading-before"),$("#traffic-loading").removeClass("traffic-loading-no-before"),$("#traffic-loading").show(),$("#traffic-results").html(""),$.ajax({url:"functions.php?function=getBusStop&var1="+e,cache:!1}).done(function(e){$("#traffic-loading").addClass("traffic-loading-no-before"),$("#traffic-loading").removeClass("traffic-loading-before"),$("#traffic-loading").hide(),console.log("Done with new busses"),$("#traffic-results").html(e)})}function getWeather(){$("#weather-loading").addClass("weather-loading-before").removeClass(".weather-loading-no-before").css("margin","20px"),$(".weather-item-container").hide();var e=["icon","desc","temp"],t={},a=0;$.each(e,function(){var n=e[a];$.ajax({url:"functions.php?function=getWeather&var1="+n,cache:!1,datatype:"html",success:function(a){t[n]=a,Object.keys(t).length==e.length&&($("#weather-loading").addClass("weather-loading-no-before").removeClass(".weather-loading-before").css("margin","0px"),$("#weather-current-icon").html(t.icon),$(".weather-current-details").empty().append(t.temp).append(t.desc),$(".weather-item-container").show())}}),a++})}$(document).ready(function(){updateClock(),setInterval("updateClock()",1e3),getBus(),getWeather(),setInterval("getWeather()",18e5),$("departure-time").each(function(){console.log($(this).attr("value"))}),$(".lights-yellow").click(function(){$(this).toggleClass("active");var e=$(this).attr("id"),t=$(this).hasClass("active")?"on":"off";$.ajax({url:"functions.php",data:{"function":"editLamps",var1:e,var2:t},type:"get",success:function(e){console.log(e)}})}),$(".lights-all").click(function(){$(".lights-yellow").removeClass("active");var e=$(this).attr("id").substring(4,this.length);$.ajax({url:"functions.php",data:{"function":"editLamps",var1:"all",var2:e},type:"get",success:function(e){console.log(e)}})}),$(".column-content").on({mouseenter:function(){$("#refresh-traffic").addClass("icon-spin")},mouseleave:function(){$("#refresh-traffic").removeClass("icon-spin")},click:function(){getBus()}},"#refresh-traffic")});