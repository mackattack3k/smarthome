function updateClock(){var t=new Date,e=new Array(7);e[0]="Söndag",e[1]="Måndag",e[2]="Tisdag",e[3]="Onsdag",e[4]="Torsdag",e[5]="Fredag",e[6]="Lördag",$("#currenttime").html(getTime(t)),$("#currentday").html(e[t.getDay()]),$("#currentdate").html(t.toLocaleDateString("sv-SE")),$(".traffic-result").each(function(){var e=$(this).children(".traffic-third").children(".departure-time").attr("value"),i=new Date(e);t>=i&&$(this).animate({bottom:"0px",opacity:.25,height:"toggle",padding:"0px",margin:"0px"},1500,"easeInQuart",function(){$(this).remove()})});var i=$("#traffic-results").children(".traffic-result").length;2>=i&&!currentlyUpdatingTrafic&&(currentlyUpdatingTrafic=!0,console.log("Too few departures, getting departures"),getDepartures())}function getDepartures(){newNotification("Updating public transport","info");var t=$("#traffic-search-input").val(),e=7424920;console.log("Getting departures for: "+t+" id: "+e),$("#traffic-loading").addClass("traffic-loading-before").removeClass("traffic-loading-no-before").show(),$("#traffic-results").html(""),$.ajax({url:"php/publicTransport.php",data:{"function":"fullHTML",stationid:e},cache:!1,datatype:"html",success:function(t){$("#traffic-loading").addClass("traffic-loading-no-before").removeClass("traffic-loading-before").hide(),$("#traffic-results").html(t),regexContainsErrorText.test(t)?(newNotification("Error updating public transport","error",1e4),currentlyUpdatingTrafic=!0):(newNotification("Public transport updated","success"),currentlyUpdatingTrafic=!0)}})}function getWeather(){newNotification("Updating weather","info"),$("#weather-loading").addClass("weather-loading-before").removeClass(".weather-loading-no-before").css("margin","20px"),$(".weather-item-container").hide(),$.ajax({url:"php/weather.php?htmlCall",data:{htmlCall:"true"},cache:!1,datatype:"html",success:function(t){$("#weather-loading").addClass("weather-loading-no-before").removeClass(".weather-loading-before").css("margin","0px"),$("#weather-data").html(t),regexContainsErrorText.test(t)?newNotification("Error getting weather","error",1e4):newNotification("Weather updated","success")}})}function newNotification(t,e,i){e="undefined"!=typeof e?e:"info",i="undefined"!=typeof i?i:5e3;var a={notifcation:"bell",info:"info",success:"check",error:"ban",warning:"exclamation-triangle"};for(key in a)if(a.hasOwnProperty(e))var n=a[e];$(".notifications-container").append("<div class='notification "+e+"'>          <div class='remove-notification icon icon-times'></div>          <div class='notification-data'>              <div class='notification-icon icon icon-"+n+"'></div>              <div class='notification-text'>"+t+"</div>          </div>        </div>").children(".notification").delay(i).fadeOut(1500,function(){$(this).remove()})}function getTime(t){var e=(t.getDate(),t.getMonth()+1,t.getFullYear(),t.getHours()),i=t.getMinutes(),a=t.getSeconds();return 10>a&&(a="0"+a),10>i&&(i="0"+i),10>e&&(e="0"+e),e+":"+i+":"+a}var currentlyUpdatingTrafic=!0,regexContainsErrorText=/\b[Ee][Rr][Rr][Oo][Rr]\b/;$(document).ready(function(){updateClock(),setInterval("updateClock()",1e3),getDepartures(),getWeather(),setInterval("getWeather()",18e5),$(".lights-yellow").click(function(){$(this).toggleClass("active");var t=$(this).attr("id"),e=$(this).hasClass("active")?"on":"off";$.ajax({url:"functions.php",data:{"function":"editLamps",var1:t,var2:e},type:"get",success:function(t){newNotification(t)}})}),$(".lights-all").click(function(){$(".lights-yellow").removeClass("active");var t=$(this).attr("id").substring(4,this.length);$.ajax({url:"functions.php",data:{"function":"editLamps",var1:"all",var2:t},type:"get",success:function(t){newNotification(t)}})}),$(".column-content").on({mouseenter:function(){$("#refresh-traffic").addClass("icon-spin")},mouseleave:function(){$("#refresh-traffic").removeClass("icon-spin")},click:function(){getDepartures()}},"#refresh-traffic"),$(".notifications-container").on({mouseleave:function(){$(this).children(".notification").fadeOut(3e3,function(){$(this).remove()})},mouseenter:function(){$(this).children(".notification").stop(!0,!1).fadeIn(500)}}),$(".notifications-container").on({click:function(){$(this).parent(".notification").animate({opacity:0},500,"easeInQuart",function(){$(this).remove()})}},".remove-notification")});